<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="shortcut icon" type="imagex/png" href="../../img/iconEmpresa.png">
  <title>Editar cliente</title>
  <link rel="stylesheet" href="../css/empresa.css" />
</head>

<body>
  <div class="header">
    <div class="container">
      <div>
        <img src="../img/iconPreto.png" alt="" />
        <h1 class="titulo">FastTec</h1>
      </div>
      <span class="highlight">Editar empresa</span>
      <a href="listaEmpresas.html">
        <img src="../img/voltarAzul.png" alt="" class="voltar" onclick="voltarLista()" id="voltarLista" />
      </a>
    </div>
  </div>

  <div class="box-Form">
    <form class="main-container" id="formulario_login" method="post" onsubmit="return updateTabela()">
      <input style="position: absolute; opacity: 0" name="idEmpresa" type="text" />
      <div class="container">
        <h3>Dados da empresa:</h3>
        <label for="name" class="input-fild">
          <span>Name:</span>
          <input type="text" id="nomeEmpresa" name="nomeEmpresa" class="input-padrao" placeholder="Nome e sobrenome"
            required minlength="4" autofocus="autofocus" />
          <div class="underline"></div>
        </label>
        <label for="name" class="input-fild">
          <span>CNPJ:</span>
          <input type="text" id="CNPJ" name="CNPJ" placeholder="Digite o cnpj" />
          <div class="underline"></div>
        </label>
        <label for="name" class="input-fild">
          <span>CEP:</span>
          <input type="text" id="cep" name="cep" placeholder="Digite o cep" />
          <div class="underline"></div>
        </label>
        <label for="name" class="input-fild">
          <span>Bairro:</span>
          <input type="text" id="bairro" name="bairro" placeholder="Digite o bairro" />
          <div class="underline"></div>
        </label>
        <label for="name" class="input-fild">
          <span>Logradouro:</span>
          <input type="text" id="logradouro" name="logradouro" placeholder="Digite o logradouro" />
          <div class="underline"></div>
        </label>
        <label for="name" class="input-fild">
          <span>Cidade:</span>
          <input type="text" id="cidade" name="cidade" placeholder="Digite o cidade" />
          <div class="underline"></div>
        </label>
        <label for="name" class="input-fild">
          <span>Número:</span>
          <input type="text" id="numero" name="numero" placeholder="Digite o número" />
          <div class="underline"></div>
        </label>
        <label for="name" class="input-fild">
          <span>Complemento:</span>
          <input type="text" id="complemento" name="complemento" placeholder="Digite complemento" />
          <div class="underline"></div>
        </label>
      </div>

      <div class="">
        <div class="forms-container">
          <h3>Dados da de acesso:</h3>
          <label for="name" class="input-fild">
            <span>Login:</span>
            <input type="text" id="loginEmpresa" name="loginEmpresa" placeholder="Digite o bairro" />
            <div class="underline"></div>
          </label>
          <label for="name" class="input-fild">
            <span>Senha:</span>
            <input type="text" id="senhaEmpresa" name="senhaEmpresa" placeholder="Digite o logradouro" />
            <div class="underline"></div>
          </label>
          <label for="name" class="input-fild">
            <span>Confirmar senha:</span>
            <input type="text" id="confiSenha" name="confiSenha" placeholder="Digite o cidade" />
            <div class="underline"></div>
          </label>
        </div>

        <div class="forms-container">
          <h3>Dados para contato:</h3>
          <label for="name" class="input-fild">
            <span>Telefone:</span>
            <input type="text" id="telefone" name="telefone" placeholder="Digite o número" />
            <div class="underline"></div>
          </label>
          <label for="name" class="input-fild">
            <span>Email:</span>
            <input type="text" id="email" name="email" placeholder="Digite o número" />

            <div class="underline"></div>
          </label>
        </div>

        <div class="botnsFuncoes">
          <a><img src="../img/salvarEscuro.png" alt="" onclick="updateTabela()" /></a>
          <span>Salvar</span>
          <!-- <input type="submit" value="Atualizar" /> -->

          <a href="cadastro.html"><img src="../img/iconMaisEscuro.png" alt="" /></a>
          <span>Novo</span>

          <a href="listaEmpresas.html">
            <img src="../img/cancelar.png" alt="" />
          </a>
          <span>Cancelar</span>
        </div>
      </div>
    </form>
  </div>
</body>

</html>

<script>
  function updateTabela() {
    var formulario = new URLSearchParams(new FormData(formulario_login));
    console.log(formulario.toString());
    console.log(formulario);
    fetch("/gestor/update", {
      method: "PUT",
      body: formulario,
    }).then((resposta) => {
      if (resposta.ok) {
        resposta.json().then((json) => {
          console.log(json);
        });
      } else {
        alert("[UPDATE] : Dados Atualizados !");

        resposta.text().then((texto) => {});
      }
    });
    return false;
  }

  function preencher() {
    const formulario = document.forms.formulario_login;
    formulario.idEmpresa.value = sessionStorage.getItem("idEmpresa");
    formulario.nomeEmpresa.value = sessionStorage.getItem("nomeEmpresa");
    formulario.CNPJ.value = sessionStorage.getItem("CNPJ");
    formulario.cep.value = sessionStorage.getItem("cep");
    formulario.bairro.value = sessionStorage.getItem("bairro");
    formulario.logradouro.value = sessionStorage.getItem("logradouro");
    formulario.cidade.value = sessionStorage.getItem("cidade");
    formulario.numero.value = sessionStorage.getItem("numero");
    formulario.complemento.value = sessionStorage.getItem("complemento");
    formulario.loginEmpresa.value = sessionStorage.getItem("loginEmpresa");
    formulario.telefone.value = sessionStorage.getItem("telefone");
    formulario.email.value = sessionStorage.getItem("email");
    formulario.senhaEmpresa.value = sessionStorage.getItem("senhaEmpresa");
  }

  preencher();
</script>